#summary A HelloWorld sample to access SQLServer with python

= A !HelloWorld sample to access SQLServer with python <g:plusone size="tall"></g:plusone>=

{{{

#                  Let Python load it's ODBC connecting tool pypyodbc
     
import pypyodbc


#                  Get a connection to MSSQL ODBC DSN via pypyodbc, and assign it to conn

conn = pypyodbc.connect('DSN=MSSQL_DSN')


#                  Give me a cursor so I can operate the database with the cursor

cur = conn.cursor()


#                  Create a saleout table in SQLServer

cur.execute('''CREATE TABLE saleout (
ID integer PRIMARY KEY IDENTITY,
customer_name VARCHAR(25), 
product_name VARCHAR(30), 
price float, 
volume int,
sell_time datetime);''')


#                  Let that take effective, Now!

cur.commit()


#                  Insert a row to the saleout table

cur.execute('''INSERT INTO saleout(customer_name,product_name,price,volume,sell_time) 
VALUES(?,?,?,?,?)''',(u'江文','Huawei Ascend mate','5000.5',2,'2012-1-21'))


#                  Let that take effective, Now!

cur.commit()


#                  Insert several rows to the saleout table

cur.execute('''INSERT INTO saleout(customer_name,product_name,price,volume,sell_time) 
VALUES(?,?,?,?,?)''',      (u'杨天真', 'Apple IPhone 5', 5500.1, 1, '2012-1-21'))
cur.execute('''INSERT INTO saleout(customer_name,product_name,price,volume,sell_time) 
VALUES(?,?,?,?,?)''',      (u'郑现实', 'Huawei Ascend D2', 5100.5, 2, '2012-1-22'))
cur.execute('''INSERT INTO saleout(customer_name,product_name,price,volume,sell_time) 
VALUES(?,?,?,?,?)''',      (u'莫小闵', 'ZTE Grand S', 5000.5, 3, '2012-1-22'))
cur.execute('''INSERT INTO saleout(customer_name,product_name,price,volume,sell_time) 
VALUES(?,?,?,?,?)''',      (u'顾小白', 'Huawei Ascend Mate', 5000.4, 2, '2012-1-22'))


#                  Let that take effective, Now!

cur.commit()


#                  Select those records about "Huawei" products

cur.execute('''SELECT * FROM saleout WHERE product_name LIKE '%Huawei%';''')


#                  Print the table headers (column descriptions)

for d in cur.description: 
    print (d[0], end=" ")


#                  Start a new line

print ('')


#                  Print the table, one row per line

for row in cur.fetchall():
    for field in row: 
        print (field, end=" ")
    print ('')
    

#                  I have done all the things, you can leave me and serve for others!

cur.close()
conn.close()


}}}

==See also:==
*[https://code.google.com/p/pypyodbc/wiki/pypyodbc_for_access_mdb_file pypyodbc's Access MDB file support features on Win32 platform]*

*[https://code.google.com/p/pypyodbc/wiki/PyPyODBC_Example_Tutorial PyPyODBC tutorial by a sales DB example]*

*[https://code.google.com/p/pypyodbc/wiki/Compatibility_with_pyodbc pypyodbc and pyodbc]*

*[http://blog.sina.com.cn/s/blog_6c64ac1501019ns8.html Python Database Programming Quick Start Tutorial (EN Version)]*
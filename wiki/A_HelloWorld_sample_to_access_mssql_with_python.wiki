#summary A HelloWorld sample to access SQLServer with python
#labels Featured

= A !HelloWorld sample to access mssql with python =

{{{

#              We will use the tool pypyodbc for Python to connect to ODBC
     
import pypyodbc


#              Get a connection to MSSQL ODBC DSN by pypyodbc, and assign it to conn

conn = pypyodbc.connect('DSN = MSSQL_DSN')


#              Give me a cursor so I can operate with the cursor

cur = conn.cursor()


#              Create a saleout table in SQLServer

cur.execute('''CREATE TABLE saleout (
ID integer PRIMARY KEY IDENTITY,
customer_name VARCHAR(25), 
product_name VARCHAR(30), 
price float, 
volume int,
sell_time datetime);''')


#              Let that take effective, Now!

cur.commit()


#              Insert a row to the saleout table

cur.execute('''INSERT INTO saleout(customer_name,product_name,price,volume,sell_time) 
VALUES(?,?,?,?,?)''',(u'江文','Huawei Ascend mate','5000.5',2,'2012-1-21'))


#              Let that take effective, Now!

cur.commit()


#              Insert several rows to the saleout table

cur.execute('''INSERT INTO saleout(customer_name,product_name,price,volume,sell_time) 
VALUES(?,?,?,?,?)''',(u'杨天真','Apple IPhone 5','5500.1',1,'2012-1-21'))
cur.execute('''INSERT INTO saleout(customer_name,product_name,price,volume,sell_time) 
VALUES(?,?,?,?,?)''',(u'郑现实','Huawei Ascend D2','5100.5',1,'2012-1-22'))
cur.execute('''INSERT INTO saleout(customer_name,product_name,price,volume,sell_time) 
VALUES(?,?,?,?,?)''',(u'莫小闵','Huawei Ascend D2','5000.5',1,'2012-1-22'))
cur.execute('''INSERT INTO saleout(customer_name,product_name,price,volume,sell_time) 
VALUES(?,?,?,?,?)''',(u'顾小白','Huawei Ascend mate','5000.5',1,'2012-1-22'))


#              Let that take effective, Now!

cur.commit()


#              Select those records about "Huawei"

cur.execute('''SELECT * FROM saleout WHERE product_name LIKE '%Huawei%';''')


#              Print the table headers (column descriptions)

for d in cur.description: 
    print (d[0], end=" ")


#              Start a new line

print ('')


#              Print the table, one row per line

for row in cur.fetchall():
    for field in row: 
        print (field, end=" ")
    print ('')
    

#              I have done all the things, you can leave me and serve for others!

conn.close()


}}}